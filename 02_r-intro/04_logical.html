<!DOCTYPE html>
<html>
  <head>
    <title>Stat 579: Logical variables and Filters</title>
    <meta charset="utf-8">
    <meta name="author" content="Heike Hofmann" />
    <meta name="date" content="2018-09-19" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Stat 579: Logical variables and Filters
### Heike Hofmann
### 2018-09-19

---

class: inverse, center, middle
# Logical variables and Filters

---

## Logical vectors

- Vectors consisting of values `TRUE` and `FALSE`

- Usually created with a logical comparison

  - `&lt;, &gt;, ==, !=, &lt;=, &gt;=`

  - `x %in% c(1, 4, 3, 7)`

- Used in `subset` or `dplyr::filter`

---

## Combining logical expressions

- `&amp;` and `|` are the logical *and* and *or*

- `!` is the logical negation

- use parentheses () when linking expressions to avoid mis-interpretation

---

## Logical Operations

![](images/logical.png)


---
class: inverse
## Your turn 


Define vector `a` to be `a &lt;- c(1, 15, 3, 20, 5, 8, 9, 10, 1, 3)`


Find the expression for the logical vector that is TRUE where `a` is:

- less than 20

- squared value is at least 100 or less than 10

- equals 1 or 3

- even &lt;br&gt;
Hint: have a look at the help for the operator `%%`

---

## `filter {dplyr}`

`filter` is a command of package `dplyr`

`filter(data, ...)` finds subset of `data` where conditions specified by logical expression in `...` are true, e.g.

  - `filter(fbi, Year == 2014)`
  - `filter(fbi, Type == "Larceny.Theft", State %in% c("Iowa", "Minnesota"))`

multiple expressions are implicitly combined by a logical and `&amp;`

Note that the command `subset` works very similarly.

Caution! there is another function called `filter` in the `stats` package. Use `::` to make sure you use the right one: `dplyr::filter`

---
class: inverse
## Your turn 

Use the `fbi` data from the `classdata` package

- Get a subset of all crimes in Iowa, Plot incidences/rates for one type of crime over time.

- Get a subset of all crimes in 2009. Plot the number or rate for one type of crime by state.

- Get a subset of the data that includes number of homicides for the last five years. Find the rate of homicides, extract all states that have a rate of greater than 90% of the rates across all states, and plot (Hint: `?quantile`).


Extra credit (1 point): submit your code (regardless of whether it works or not) in Canvas (yourturn-checkin-1).

---

## Information extraction: useful commands

Number of records in a data set:
```
nrow(dataset)  
```

Quantiles:
```
quantile(variable, probs=0.001, na.rm=T)  
```

Find all indices for which an expression is TRUE:
```
which(logical variable)  
```

Retrieve index of maximum/minimum value:
```
which.max(variable)
which.min(variable) 
```

---
class: inverse
## Your turn 


Use the `fbi` data object to answer the following questions: 

- how many reports of Burglaries are there for California?

- for any of the violent crimes, which state had the highest rate (and for which crime) in 2014? in 1961? 


Use the `fbiwide` data object to answer the following question: 

- in how many states in 2011 were there more vehicle thefts than robberies? (which states are those?)



---

## Updating elements in a vector

You can take a subset and update the original data:

```r
a &lt;- 1:4
a
```

```
## [1] 1 2 3 4
```

```r
a[2:3] &lt;- 0
a
```

```
## [1] 1 0 0 4
```

```r
replace(a, a == 0, -1)
```

```
## [1]  1 -1 -1  4
```

Very useful in combination with logical subsetting

---

## Updating elements in a data set

data sets and their parts can be used as right hand side of an assignment:


```r
library(classdata)

# introduces new variable in the data set fbiwide
fbiwide$murder.rate &lt;- fbiwide$Murder/fbiwide$Population*100000

names(fbiwide)
```

```
##  [1] "State"               "Abb"                 "Year"               
##  [4] "Population"          "Aggravated.assault"  "Burglary"           
##  [7] "Larceny.theft"       "Legacy.rape"         "Motor.vehicle.theft"
## [10] "Murder"              "Rape"                "Robbery"            
## [13] "murder.rate"
```

if that variable exists before, it is being over-written/updated

---
class: inverse
## Your turn 


The gapminder data from homework 2 is available [here](https://raw.githubusercontent.com/Stat579-at-ISU/stat579-at-isu.github.io/master/homework/data/gapminder-5060.csv). 

- `read.csv` helps you read the gapminder data from the given link. Store the result in an object.

- What format does the object have?

- Replace the problematic value in life expectancy for Canada in 1957  by the value 69.96.
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
